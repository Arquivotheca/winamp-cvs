/***************************************************************************\
 *                         Fraunhofer IIS 
 *                 (c) 2004 - 2008 Fraunhofer IIS
 *                       All Rights Reserved.
 *
 *
 *    This software and/or program is protected by copyright law and
 *    international treaties. Any reproduction or distribution of this
 *    software and/or program, or any portion of it, may result in severe
 *    civil and criminal penalties, and will be prosecuted to the maximum
 *    extent possible under law.
 *
\***************************************************************************/

#include <assert.h>


#define M_SQRT1_2 0.70710678118654752440084436210485
#ifdef WIN32
__declspec(align(32)) 
#endif
static const float trigData_1024[]={
+0.92387952832938f,-0.38268344246110f,+0.38268340207705f,-0.92387954505700f,
+0.38268340207705f,-0.92387954505700f,-0.92387949487413f,+0.38268352322922f,
+0.98078527933727f,-0.19509032737506f,+0.83146960319576f,-0.55557024664886f,
+0.55557021030417f,-0.83146962748051f,-0.98078529639261f,-0.19509024163209f,
+0.83146960319576f,-0.55557024664886f,-0.19509037024655f,-0.98078527080960f,
+0.19509028450358f,-0.98078528786494f,-0.55557013761478f,+0.83146967605000f,
+0.99518472640442f,-0.09801714304837f,+0.95694033335307f,-0.29028468509744f,
+0.63439326515713f,-0.77301046896098f,-0.88192129911998f,-0.47139667177286f,
+0.88192125790917f,-0.47139674887287f,+0.09801709954746f,-0.99518473068888f,
+0.29028464326824f,-0.95694034604181f,-0.77301038577034f,+0.63439336652521f,
+0.95694033335307f,-0.29028468509744f,+0.63439326515713f,-0.77301046896098f,
+0.47139671032287f,-0.88192127851457f,-0.99518471783548f,+0.09801723005018f,
+0.77301044123077f,-0.63439329894649f,-0.47139678742288f,-0.88192123730376f,
+0.09801709954746f,-0.99518473068888f,-0.29028455960986f,+0.95694037141930f,
+0.99879545613815f,-0.04906767569175f,+0.98917650936349f,-0.14673047850895f,
+0.67155893764089f,-0.74095114094968f,-0.80320757298005f,-0.59569924853696f,
+0.90398928786715f,-0.42755510454377f,+0.24298014412707f,-0.97003126215601f,
+0.33688982123894f,-0.94154407668765f,-0.85772855733118f,+0.51410283206629f,
+0.97003125153501f,-0.24298018652848f,+0.74095111159491f,-0.67155897002889f,
+0.51410271958876f,-0.85772862474762f,-0.99879546042778f,-0.04906758837428f,
+0.80320752090236f,-0.59569931875559f,-0.33688990355134f,-0.94154404723580f,
+0.14673043527067f,-0.98917651577728f,-0.42755498599988f,+0.90398934393423f,
+0.98917650936349f,-0.14673047850895f,+0.90398928786715f,-0.42755510454377f,
+0.59569928364628f,-0.80320754694121f,-0.94154409141357f,-0.33688978008274f,
+0.85772860227547f,-0.51410275708127f,-0.04906771935049f,-0.99879545399333f,
+0.24298014412707f,-0.97003126215601f,-0.67155887286488f,+0.74095119965923f,
+0.94154406196172f,-0.33688986239514f,+0.51410271958876f,-0.85772862474762f,
+0.42755506502914f,-0.90398930655618f,-0.97003123029301f,+0.24298027133131f,
+0.74095111159491f,-0.67155897002889f,-0.59569935386491f,-0.80320749486352f,
+0.04906763203302f,-0.99879545828296f,-0.14673034879411f,+0.98917652860486f,
+0.99969881867944f,-0.02454122920570f,+0.99729045652796f,-0.07356456564309f,
+0.68954052841349f,-0.72424709849280f,-0.75720889067145f,-0.65317279175430f,
+0.91420975099834f,-0.40524132461973f,+0.31368170732444f,-0.94952819151936f,
+0.35989500531095f,-0.93299281087918f,-0.89322425605471f,+0.44961141933397f,
+0.97570212869173f,-0.21910124615443f,+0.78834641628128f,-0.61523160511832f,
+0.53499759622899f,-0.84485358023104f,-0.99247954488216f,-0.12241059182317f,
+0.81758480331980f,-0.57580820537791f,-0.26671280684364f,-0.96377605213327f,
+0.17096185040299f,-0.98527764904456f,-0.49289809061113f,+0.87008704867496f,
+0.99247953418068f,-0.12241067858849f,+0.93299279514767f,-0.35989504609337f,
+0.61523157065860f,-0.78834644317391f,-0.91420978642566f,-0.40524124469697f,
+0.87008698403917f,-0.49289820470927f,+0.02454118550747f,-0.99969881975217f,
+0.26671272258766f,-0.96377607545004f,-0.72424700807047f,+0.68954062338703f,
+0.94952817780790f,-0.31368174882963f,+0.57580816964014f,-0.81758482848917f,
+0.44961130220174f,-0.89322431501413f,-0.98527762662562f,+0.17096197960656f,
+0.75720883356927f,-0.65317285795160f,-0.53499767008844f,-0.84485353346006f,
+0.07356452205013f,-0.99729045974357f,-0.21910111820654f,+0.97570215742338f,
+0.99729045652796f,-0.07356456564309f,+0.97570212869173f,-0.21910124615443f,
+0.65317282485295f,-0.75720886212036f,-0.84485360361652f,-0.53499755929927f,
+0.89322429536099f,-0.44961134124582f,+0.17096185040299f,-0.98527764904456f,
+0.31368170732444f,-0.94952819151936f,-0.81758475298104f,+0.57580827685345f,
+0.96377606379165f,-0.26671276471565f,+0.68954052841349f,-0.72424709849280f,
+0.49289816667656f,-0.87008700558444f,-0.99969881653398f,+0.02454131660215f,
+0.78834641628128f,-0.61523160511832f,-0.40524136458111f,-0.91420973328468f,
+0.12241063520583f,-0.99247953953142f,-0.35989492374613f,+0.93299284234220f,
+0.98527764157158f,-0.17096189347085f,+0.87008698403917f,-0.49289820470927f,
+0.57580816964014f,-0.81758482848917f,-0.96377608710842f,-0.26671268045966f,
+0.84485355684555f,-0.53499763315872f,-0.12241072197115f,-0.99247952882994f,
+0.21910120350513f,-0.97570213826895f,-0.61523150173916f,+0.78834649695916f,
+0.93299279514767f,-0.35989504609337f,+0.44961130220174f,-0.89322431501413f,
+0.40524128465835f,-0.91420976871200f,-0.94952815038496f,+0.31368183184003f,
+0.72424706835203f,-0.68954056007134f,-0.65317289105025f,-0.75720880501818f,
+0.02454118550747f,-0.99969881975217f,-0.07356443486423f,+0.99729046617478f,
+0.99992470183495f,-0.01227153862719f,+0.99932238455064f,-0.03680722396515f,
+0.69837623352176f,-0.71573084078581f,-0.73265431699470f,-0.68060094900685f,
+0.91911384725003f,-0.39399205041886f,+0.34841864855985f,-0.93733902369192f,
+0.37131716319504f,-0.92850609277311f,-0.90916794170778f,+0.41642965044631f,
+0.97831736951726f,-0.20711138187176f,+0.81045718805019f,-0.58579787157157f,
+0.54532496523582f,-0.83822472063913f,-0.98730143134043f,-0.15885806140429f,
+0.82458929331848f,-0.56573182458169f,-0.23105815712206f,-0.97293994060649f,
+0.18303985001812f,-0.98310549449453f,-0.52458958411973f,+0.85135525383537f,
+0.99390696966359f,-0.11022221034861f,+0.94560732238104f,-0.32531030088111f,
+0.62485946867927f,-0.78073724414931f,-0.89867449849694f,-0.43861617132895f,
+0.87607008744420f,-0.48218378434525f,+0.06132069437734f,-0.99811811547586f,
+0.27851965494690f,-0.96043052940245f,-0.74913632326673f,+0.66241585817552f,
+0.95330603777585f,-0.30200595745796f,+0.60551102102124f,-0.79583692011732f,
+0.46053868398014f,-0.88763963440004f,-0.99090262315681f,+0.13458079885686f,
+0.76516725309013f,-0.64383155778395f,-0.50353843417800f,-0.86397282671712f,
+0.08579727117588f,-0.99631261572800f,-0.25486553973543f,+0.96697650263870f,
+0.99811811279545f,-0.06132073800647f,+0.98310548649361f,-0.18303989299103f,
+0.66241575993814f,-0.74913641013208f,-0.82458934277633f,-0.56573175249380f,
+0.89867446015190f,-0.43861624989357f,+0.20711133910815f,-0.97831737857038f,
+0.32531025954730f,-0.94560733660080f,-0.83822464912839f,+0.54532507515572f,
+0.96697646921711f,-0.25486566653909f,+0.71573081025881f,-0.69837626480735f,
+0.50353835864710f,-0.86397287073784f,-0.99992470290776f,-0.01227145121099f,
+0.79583689364959f,-0.60551105580837f,-0.37131724436762f,-0.92850606031153f,
+0.13458066891567f,-0.99090264080494f,-0.39399192989162f,+0.91911389891584f,
+0.98730141745262f,-0.15885814771692f,+0.88763961426925f,-0.46053872278010f,
+0.58579783614536f,-0.81045721365623f,-0.95330606417805f,-0.30200587411730f,
+0.85135518504375f,-0.52458969576149f,-0.08579735827630f,-0.99631260822736f,
+0.23105807206495f,-0.97293996080623f,-0.64383145744437f,+0.76516733751844f,
+0.93733900846206f,-0.34841868953224f,+0.48218374605101f,-0.87607010852113f,
+0.41642953122332f,-0.90916799631593f,-0.96043049287899f,+0.27851978089215f,
+0.73265425749467f,-0.68060101305753f,-0.62485953693349f,-0.78073718952236f,
+0.03680718028338f,-0.99932238615953f,-0.11022208001345f,+0.99390698411748f,
+0.99932238455064f,-0.03680722396515f,+0.99390696966359f,-0.11022221034861f,
+0.68060098103219f,-0.73265428724469f,-0.78073727146279f,-0.62485943455216f,
+0.90916797811322f,-0.41642957096432f,+0.27851965494690f,-0.96043052940245f,
+0.34841864855985f,-0.93733902369192f,-0.87607004529035f,+0.48218386093373f,
+0.97293995070636f,-0.23105811459350f,+0.76516725309013f,-0.64383155778395f,
+0.52458965854757f,-0.85135520797429f,-0.99631261947832f,-0.08579722762567f,
+0.81045718805019f,-0.58579787157157f,-0.30200599912830f,-0.95330602457475f,
+0.15885810456061f,-0.98730142439653f,-0.46053860638022f,+0.88763967466161f,
+0.99090263492223f,-0.13458071222940f,+0.91911384725003f,-0.39399205041886f,
+0.60551102102124f,-0.79583692011732f,-0.92850610900390f,-0.37131712260875f,
+0.86397284872748f,-0.50353839641255f,-0.01227158233529f,-0.99992470129855f,
+0.25486562427120f,-0.96697648035764f,-0.69837617095058f,+0.71573090183980f,
+0.94560732238104f,-0.32531030088111f,+0.54532496523582f,-0.83822472063913f,
+0.43861621061126f,-0.89867447932442f,-0.97831735141100f,+0.20711146739898f,
+0.74913638117696f,-0.66241579268394f,-0.56573186062563f,-0.82458926858956f,
+0.06132069437734f,-0.99811811547586f,-0.18303976407230f,+0.98310551049638f,
+0.99631261197768f,-0.08579731472609f,+0.96697646921711f,-0.25486566653909f,
+0.64383152433742f,-0.76516728123290f,-0.86397289274820f,-0.50353832088164f,
+0.88763961426925f,-0.46053872278010f,+0.13458066891567f,-0.99090264080494f,
+0.30200591578763f,-0.95330605097695f,-0.79583684071413f,+0.60551112538265f,
+0.96043051722796f,-0.27851969692865f,+0.66241575993814f,-0.74913641013208f,
+0.48218374605101f,-0.87607010852113f,-0.99811810743461f,+0.06132082526473f,
+0.78073721683583f,-0.62485950280638f,-0.43861628917588f,-0.89867444097937f,
+0.11022216690356f,-0.99390697448156f,-0.32531017687968f,+0.94560736504033f,
+0.98310548649361f,-0.18303989299103f,+0.85135518504375f,-0.52458969576149f,
+0.56573178853774f,-0.82458931804741f,-0.97293997090610f,-0.23105802953639f,
+0.83822469680222f,-0.54532500187578f,-0.15885819087324f,-0.98730141050871f,
+0.20711133910815f,-0.97831737857038f,-0.58579776529293f,+0.81045726486830f,
+0.92850607654232f,-0.37131720378133f,+0.41642953122332f,-0.90916799631593f,
+0.39399201024311f,-0.91911386447197f,-0.93733897800232f,+0.34841877147702f,
+0.71573081025881f,-0.69837626480735f,-0.68060104508286f,-0.73265422774465f,
+0.01227149491909f,-0.99992470237136f,-0.03680709291984f,+0.99932238937732f,
+0.92387952832938f,-0.38268344246110f,+0.38268340207705f,-0.92387954505700f,
+0.38268340207705f,-0.92387954505700f,-0.92387949487413f,+0.38268352322922f,
+0.98078527933727f,-0.19509032737506f,+0.83146960319576f,-0.55557024664886f,
+0.55557021030417f,-0.83146962748051f,-0.98078529639261f,-0.19509024163209f,
+0.83146960319576f,-0.55557024664886f,-0.19509037024655f,-0.98078527080960f,
+0.19509028450358f,-0.98078528786494f,-0.55557013761478f,+0.83146967605000f,
+0.99518472640442f,-0.09801714304837f,+0.95694033335307f,-0.29028468509744f,
+0.63439326515713f,-0.77301046896098f,-0.88192129911998f,-0.47139667177286f,
+0.88192125790917f,-0.47139674887287f,+0.09801709954746f,-0.99518473068888f,
+0.29028464326824f,-0.95694034604181f,-0.77301038577034f,+0.63439336652521f,
+0.95694033335307f,-0.29028468509744f,+0.63439326515713f,-0.77301046896098f,
+0.47139671032287f,-0.88192127851457f,-0.99518471783548f,+0.09801723005018f,
+0.77301044123077f,-0.63439329894649f,-0.47139678742288f,-0.88192123730376f,
+0.09801709954746f,-0.99518473068888f,-0.29028455960986f,+0.95694037141930f,
+0.99879545613815f,-0.04906767569175f,+0.98917650936349f,-0.14673047850895f,
+0.67155893764089f,-0.74095114094968f,-0.80320757298005f,-0.59569924853696f,
+0.90398928786715f,-0.42755510454377f,+0.24298014412707f,-0.97003126215601f,
+0.33688982123894f,-0.94154407668765f,-0.85772855733118f,+0.51410283206629f,
+0.97003125153501f,-0.24298018652848f,+0.74095111159491f,-0.67155897002889f,
+0.51410271958876f,-0.85772862474762f,-0.99879546042778f,-0.04906758837428f,
+0.80320752090236f,-0.59569931875559f,-0.33688990355134f,-0.94154404723580f,
+0.14673043527067f,-0.98917651577728f,-0.42755498599988f,+0.90398934393423f,
+0.98917650936349f,-0.14673047850895f,+0.90398928786715f,-0.42755510454377f,
+0.59569928364628f,-0.80320754694121f,-0.94154409141357f,-0.33688978008274f,
+0.85772860227547f,-0.51410275708127f,-0.04906771935049f,-0.99879545399333f,
+0.24298014412707f,-0.97003126215601f,-0.67155887286488f,+0.74095119965923f,
+0.94154406196172f,-0.33688986239514f,+0.51410271958876f,-0.85772862474762f,
+0.42755506502914f,-0.90398930655618f,-0.97003123029301f,+0.24298027133131f,
+0.74095111159491f,-0.67155897002889f,-0.59569935386491f,-0.80320749486352f,
+0.04906763203302f,-0.99879545828296f,-0.14673034879411f,+0.98917652860486f,
+0.99969881867944f,-0.02454122920570f,+0.99729045652796f,-0.07356456564309f,
+0.68954052841349f,-0.72424709849280f,-0.75720889067145f,-0.65317279175430f,
+0.91420975099834f,-0.40524132461973f,+0.31368170732444f,-0.94952819151936f,
+0.35989500531095f,-0.93299281087918f,-0.89322425605471f,+0.44961141933397f,
+0.97570212869173f,-0.21910124615443f,+0.78834641628128f,-0.61523160511832f,
+0.53499759622899f,-0.84485358023104f,-0.99247954488216f,-0.12241059182317f,
+0.81758480331980f,-0.57580820537791f,-0.26671280684364f,-0.96377605213327f,
+0.17096185040299f,-0.98527764904456f,-0.49289809061113f,+0.87008704867496f,
+0.99247953418068f,-0.12241067858849f,+0.93299279514767f,-0.35989504609337f,
+0.61523157065860f,-0.78834644317391f,-0.91420978642566f,-0.40524124469697f,
+0.87008698403917f,-0.49289820470927f,+0.02454118550747f,-0.99969881975217f,
+0.26671272258766f,-0.96377607545004f,-0.72424700807047f,+0.68954062338703f,
+0.94952817780790f,-0.31368174882963f,+0.57580816964014f,-0.81758482848917f,
+0.44961130220174f,-0.89322431501413f,-0.98527762662562f,+0.17096197960656f,
+0.75720883356927f,-0.65317285795160f,-0.53499767008844f,-0.84485353346006f,
+0.07356452205013f,-0.99729045974357f,-0.21910111820654f,+0.97570215742338f,
+0.99729045652796f,-0.07356456564309f,+0.97570212869173f,-0.21910124615443f,
+0.65317282485295f,-0.75720886212036f,-0.84485360361652f,-0.53499755929927f,
+0.89322429536099f,-0.44961134124582f,+0.17096185040299f,-0.98527764904456f,
+0.31368170732444f,-0.94952819151936f,-0.81758475298104f,+0.57580827685345f,
+0.96377606379165f,-0.26671276471565f,+0.68954052841349f,-0.72424709849280f,
+0.49289816667656f,-0.87008700558444f,-0.99969881653398f,+0.02454131660215f,
+0.78834641628128f,-0.61523160511832f,-0.40524136458111f,-0.91420973328468f,
+0.12241063520583f,-0.99247953953142f,-0.35989492374613f,+0.93299284234220f,
+0.98527764157158f,-0.17096189347085f,+0.87008698403917f,-0.49289820470927f,
+0.57580816964014f,-0.81758482848917f,-0.96377608710842f,-0.26671268045966f,
+0.84485355684555f,-0.53499763315872f,-0.12241072197115f,-0.99247952882994f,
+0.21910120350513f,-0.97570213826895f,-0.61523150173916f,+0.78834649695916f,
+0.93299279514767f,-0.35989504609337f,+0.44961130220174f,-0.89322431501413f,
+0.40524128465835f,-0.91420976871200f,-0.94952815038496f,+0.31368183184003f,
+0.72424706835203f,-0.68954056007134f,-0.65317289105025f,-0.75720880501818f,
+0.02454118550747f,-0.99969881975217f,-0.07356443486423f,+0.99729046617478f,
+0.92387952832938f,-0.38268344246110f,+0.38268340207705f,-0.92387954505700f,
+0.38268340207705f,-0.92387954505700f,-0.92387949487413f,+0.38268352322922f,
+0.98078527933727f,-0.19509032737506f,+0.83146960319576f,-0.55557024664886f,
+0.55557021030417f,-0.83146962748051f,-0.98078529639261f,-0.19509024163209f,
+0.83146960319576f,-0.55557024664886f,-0.19509037024655f,-0.98078527080960f,
+0.19509028450358f,-0.98078528786494f,-0.55557013761478f,+0.83146967605000f,
+0.99518472640442f,-0.09801714304837f,+0.95694033335307f,-0.29028468509744f,
+0.63439326515713f,-0.77301046896098f,-0.88192129911998f,-0.47139667177286f,
+0.88192125790917f,-0.47139674887287f,+0.09801709954746f,-0.99518473068888f,
+0.29028464326824f,-0.95694034604181f,-0.77301038577034f,+0.63439336652521f,
+0.95694033335307f,-0.29028468509744f,+0.63439326515713f,-0.77301046896098f,
+0.47139671032287f,-0.88192127851457f,-0.99518471783548f,+0.09801723005018f,
+0.77301044123077f,-0.63439329894649f,-0.47139678742288f,-0.88192123730376f,
+0.09801709954746f,-0.99518473068888f,-0.29028455960986f,+0.95694037141930f,
+0.99879545613815f,-0.04906767569175f,+0.98917650936349f,-0.14673047850895f,
+0.67155893764089f,-0.74095114094968f,-0.80320757298005f,-0.59569924853696f,
+0.90398928786715f,-0.42755510454377f,+0.24298014412707f,-0.97003126215601f,
+0.33688982123894f,-0.94154407668765f,-0.85772855733118f,+0.51410283206629f,
+0.97003125153501f,-0.24298018652848f,+0.74095111159491f,-0.67155897002889f,
+0.51410271958876f,-0.85772862474762f,-0.99879546042778f,-0.04906758837428f,
+0.80320752090236f,-0.59569931875559f,-0.33688990355134f,-0.94154404723580f,
+0.14673043527067f,-0.98917651577728f,-0.42755498599988f,+0.90398934393423f,
+0.98917650936349f,-0.14673047850895f,+0.90398928786715f,-0.42755510454377f,
+0.59569928364628f,-0.80320754694121f,-0.94154409141357f,-0.33688978008274f,
+0.85772860227547f,-0.51410275708127f,-0.04906771935049f,-0.99879545399333f,
+0.24298014412707f,-0.97003126215601f,-0.67155887286488f,+0.74095119965923f,
+0.94154406196172f,-0.33688986239514f,+0.51410271958876f,-0.85772862474762f,
+0.42755506502914f,-0.90398930655618f,-0.97003123029301f,+0.24298027133131f,
+0.74095111159491f,-0.67155897002889f,-0.59569935386491f,-0.80320749486352f,
+0.04906763203302f,-0.99879545828296f,-0.14673034879411f,+0.98917652860486f,
+0.92387952832938f,-0.38268344246110f,+0.38268340207705f,-0.92387954505700f,
+0.38268340207705f,-0.92387954505700f,-0.92387949487413f,+0.38268352322922f,
+0.98078527933727f,-0.19509032737506f,+0.83146960319576f,-0.55557024664886f,
+0.55557021030417f,-0.83146962748051f,-0.98078529639261f,-0.19509024163209f,
+0.83146960319576f,-0.55557024664886f,-0.19509037024655f,-0.98078527080960f,
+0.19509028450358f,-0.98078528786494f,-0.55557013761478f,+0.83146967605000f,
+0.99518472640442f,-0.09801714304837f,+0.95694033335307f,-0.29028468509744f,
+0.63439326515713f,-0.77301046896098f,-0.88192129911998f,-0.47139667177286f,
+0.88192125790917f,-0.47139674887287f,+0.09801709954746f,-0.99518473068888f,
+0.29028464326824f,-0.95694034604181f,-0.77301038577034f,+0.63439336652521f,
+0.95694033335307f,-0.29028468509744f,+0.63439326515713f,-0.77301046896098f,
+0.47139671032287f,-0.88192127851457f,-0.99518471783548f,+0.09801723005018f,
+0.77301044123077f,-0.63439329894649f,-0.47139678742288f,-0.88192123730376f,
+0.09801709954746f,-0.99518473068888f,-0.29028455960986f,+0.95694037141930f,
+0.92387952832938f,-0.38268344246110f,+0.38268340207705f,-0.92387954505700f,
+0.38268340207705f,-0.92387954505700f,-0.92387949487413f,+0.38268352322922f,
+0.98078527933727f,-0.19509032737506f,+0.83146960319576f,-0.55557024664886f,
+0.55557021030417f,-0.83146962748051f,-0.98078529639261f,-0.19509024163209f,
+0.83146960319576f,-0.55557024664886f,-0.19509037024655f,-0.98078527080960f,
+0.19509028450358f,-0.98078528786494f,-0.55557013761478f,+0.83146967605000f,
+0.92387952832938f,-0.38268344246110f,+0.38268340207705f,-0.92387954505700f,
+0.38268340207705f,-0.92387954505700f,-0.92387949487413f,+0.38268352322922f
};


/*
  ordering re(0),im(0)...re(n-1),im(n-1)
*/

void splitRadixComplexFFT(int n, float az[])
{
    int m, mq, i, j, j1, j2, j3, k;
    float w1r, w1i, w3r, w3i;
    float x0r, x0i, x1r, x1i, x3r, x3i;
    float const *trigPtr = trigData_1024;


    assert(n == 512);
    /* ---- scrambler ---- */
    i = 0;
    for (j = 1; j < n - 1; j++) {
        for (k = n >> 1; k > (i ^= k); k >>= 1);
        if (j < i) {
            x0r = az[2*j];
            x0i = az[2*j+1];
            az[2*j] = az[2*i];
            az[2*j+1] = az[2*i+1];
            az[2*i] = x0r;
            az[2*i+1] = x0i;
        }
    }
  
    /* ---- L shaped butterflies ---- */
    /*
      theta = -2 * atan(1.0) / n;
    */
    for (m = 4; m <= n; m <<= 1) {
        mq = m >> 2;
        /* ---- W == 1 ---- */
        for (k = mq; k >= 1; k >>= 2) {
            for (j = mq - k; j < mq - (k >> 1); j++) {
                j1 = j + mq;
                j2 = j1 + mq;
                j3 = j2 + mq;
                x1r = az[2*j] - az[2*j1];
                x1i = az[2*j+1] - az[2*j1+1];
                az[2*j] += az[2*j1];
                az[2*j+1] += az[2*j1+1];
                x3r = az[2*j3] - az[2*j2];
                x3i = az[2*j3+1] - az[2*j2+1];
                az[2*j2] += az[2*j3];
                az[2*j2+1] += az[2*j3+1];
                az[2*j1] = x1r - x3i;
                az[2*j1+1] = x1i + x3r;
                az[2*j3] = x1r + x3i;
                az[2*j3+1] = x1i - x3r;
            }
        }
       
        if (m == n) continue;
        /* ---- W == exp(-pi*i/4) ---- */
        /*
          irev = n >> 1;
          w1r =  cos(theta * irev);
        */
        w1r = (float) M_SQRT1_2;
        for (k = mq; k >= 1; k >>= 2) {
            for (j = m + mq - k; j < m + mq - (k >> 1); j++) {
                j1 = j + mq;
                j2 = j1 + mq;
                j3 = j2 + mq;
                x1r = az[2*j] - az[2*j1];
                x1i = az[2*j+1] - az[2*j1+1];
                az[2*j] += az[2*j1];
                az[2*j+1] += az[2*j1+1];
                x3r = az[2*j3] - az[2*j2];
                x3i = az[2*j3+1] - az[2*j2+1];
                az[2*j2] += az[2*j3];
                az[2*j2+1] += az[2*j3+1];
                x0r = x1r - x3i;
                x0i = x1i + x3r;
                az[2*j1] = w1r * (x0r + x0i);
                az[2*j1+1] = w1r * (x0i - x0r);
                x0r = x1r + x3i;
                x0i = x1i - x3r;
                az[2*j3] = w1r * (-x0r + x0i);
                az[2*j3+1] = w1r * (-x0i - x0r);
            }
        }

        /* ---- W != 1, exp(-pi*i/4) ---- */
        for (i = 2 * m; i < n; i += m) {
        /*  
           for (k = n >> 1; k > (irev ^= k); k >>= 1);
            w1r = cos(theta * irev);
            w1i = sin(theta * irev);
            w3r = cos(theta * 3 * irev);
            w3i = sin(theta * 3 * irev);
            printf("%+.14ff,%+.14ff,%+.14ff,%+.14ff,\n", cos(theta * irev), sin(theta * irev),cos(theta * 3 * irev),sin(theta * 3 * irev));
         */ 
            w1r = *trigPtr++;
            w1i = *trigPtr++;
            w3r = *trigPtr++;
            w3i = *trigPtr++;
            for (k = mq; k >= 1; k >>= 2) {
                for (j = i + mq - k; j < i + mq - (k >> 1); j++) {
                    j1 = j + mq;
                    j2 = j1 + mq;
                    j3 = j2 + mq;
                    x1r = az[2*j] - az[2*j1];
                    x1i = az[2*j+1] - az[2*j1+1];
                    az[2*j] += az[2*j1];
                    az[2*j+1] += az[2*j1+1];
                    x3r = az[2*j3] - az[2*j2];
                    x3i = az[2*j3+1] - az[2*j2+1];
                    az[2*j2] += az[2*j3];
                    az[2*j2+1] += az[2*j3+1];
                    x0r = x1r - x3i;
                    x0i = x1i + x3r;
                    az[2*j1] = w1r * x0r - w1i * x0i;
                    az[2*j1+1] = w1r * x0i + w1i * x0r;
                    x0r = x1r + x3i;
                    x0i = x1i - x3r;
                    az[2*j3] = w3r * x0r - w3i * x0i;
                    az[2*j3+1] = w3r * x0i + w3i * x0r;
                }
            }
        }
    }
    /* ---- radix 2 butterflies ---- */
    mq = n >> 1;
    for (k = mq; k >= 1; k >>= 2) {
        for (j = mq - k; j < mq - (k >> 1); j++) {
            j1 = mq + j;
            x0r = az[2*j] - az[2*j1];
            x0i = az[2*j+1] - az[2*j1+1];
            az[2*j] += az[2*j1];
            az[2*j+1] += az[2*j1+1];
            az[2*j1] = x0r;
            az[2*j1+1] = x0i;
        }
    }
}

