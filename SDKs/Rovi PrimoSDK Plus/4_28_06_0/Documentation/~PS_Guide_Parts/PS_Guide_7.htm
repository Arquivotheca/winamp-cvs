<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<TITLE>PrimoSDK Guide - Chapter 7</TITLE>
<!-- PrimoSDK version 2 -->
<!-- HTML version generated by DelPhi on 050726 -->
<!-- (c) Sonic Solutions. All Rights Reserved. -->
<LINK REL=STYLESHEET TYPE="text/css" HREF="PS_Styles-MAIN.css">
</HEAD>
<BODY>
<A ID="chapter"><IMG SRC="PS_Images/PS_Banner.jpg" WIDTH=520 HEIGHT=72></A>
<P CLASS="IndentSans" ALIGN="Right">&#169; Sonic Solutions<SUP>&#153;</SUP>. All Rights Reserved.</P>
<P CLASS="Heading1"><A ID="Advanced Audio Addendum">7 &nbsp;Advanced Audio Addendum</A></P>
<P CLASS="IndentSerif">This addendum documents additional audio-related functions offering Advanced Audio capabilities that are licensed separately from the standard version of PrimoSDK. These calls fall into the following categories:</P>
<UL CLASS="IndentSerif_List"><LI><A HREF="#WMA Playlists and DRM">WMA Playlists and DRM</A></LI>
<LI><A HREF="#Track Management">Track Management</A></LI>
<LI><A HREF="#Write to Disc">Write to Disc</A></LI>
<LI><A HREF="#Playback Control">Playback Control</A></LI></UL>
<P CLASS="IndentSerif">Each call entry below includes a description of the usage of the call, the value(s) returned by the call, and the call&#39;s parameter(s), if any. Parameters are categorized as follows:</P>
<UL CLASS="IndentSerif_List"><LI><B>Input</B> &#151; the value is passed into the function from the object; the object is not modified by the call.</LI>
<LI><B>Input&#47;Output</B> &#151;  the value is passed into the function from the object; the object may subsequently be modified by the call.</LI>
<LI><B>Output</B> &#151; the value of the object is filled in by the function.</LI></UL>
<P CLASS="IndentSerif"><B>NOTE</B>: For information on standard audio-related PrimoSDK calls, see <A HREF="#Audio CD Images in Chapter 6. "><SPAN CLASS="Arial_Inline"><B>Audio CD Images</B> </SPAN>in Chapter 6. </A>To find a specific call by name, see <A HREF="PS_Guide_5.htm">Chapter 5</A>, <SPAN CLASS="Arial_Inline"><B>Alphabetic Call List</B></SPAN>.</P>
<HR SIZE=2 WIDTH="93%"><TABLE width="93%" align=center border=0><TBODY><col><col width=50><TR><TD CLASS="Heading2"><A ID="WMA Playlists and DRM">7.1 &nbsp;WMA Playlists and DRM</A></TD><TD class="IndentSansVisited">go: &nbsp;<A HRef="#chapter">top</A></TD></TR></TBODY></TABLE>
<P CLASS="IndentSerif">This section covers the following calls:</P>
<P CLASS="Code"><A HREF="#PrimoSDK_SetAudioLibraryCallback">PrimoSDK_SetAudioLibraryCallback</A>, <A HREF="#PrimoSDK_NewAudioPlaylist">PrimoSDK_NewAudioPlaylist</A>, <A HREF="#PrimoSDK_CheckAudioPlaylist">PrimoSDK_CheckAudioPlaylist</A></P>
<P CLASS="IndentSerif">This call is used to implement Windows Media Audio digital rights management (DRM).</P>
<HR noshade SIZE=1 WIDTH="93%"><TABLE width="93%" align=center border=0><TBODY><col><col width=110><TR><TD CLASS="Heading4"><A ID="PrimoSDK_SetAudioLibraryCallback">PrimoSDK_SetAudioLibraryCallback</A></TD><TD class="IndentSansVisited">go: &nbsp;<A HRef="#chapter">top</A> &nbsp; &nbsp;| &nbsp; &nbsp;<A HRef="#WMA Playlists and DRM">section</A></TD></TR></TBODY></TABLE>
<P CLASS="IndentSerif">PrimoSDK_SetAudioLibraryCallback passes a pointer to a callback that sets up Microsoft Windows Media Audio (WMA) digital rights management (DRM) libraries required for non-streaming audio operations. Usage of the callback, which is specified with the parameter <I>pCallback</I>, is shown in the following example routine:</P>
<P CLASS="Code">HRESULT PrimoSDKLibSetupCallback(DWORD dwRights, void **ppReader)<BR>
{<BR>
  return WMCreateReader(NULL, dwRights,(IWMReader**) ppReader);<BR>
}</P>
<P CLASS="IndentSerif"><B>NOTE</B>: This function may be called anytime after <A HREF="PS_Guide_6.htm#PrimoSDK_Init">PrimoSDK_Init</A> and before <A HREF="PS_Guide_6.htm#PrimoSDK_NewAudio">PrimoSDK_NewAudio</A>.</P>
<P CLASS="SubHead_Sans11">Syntax</P>
<P CLASS="Code">DWORD WINAPI PrimoSDK_SetAudioLibraryCallback(</P>
<P CLASS="Code_Indent">DWORD dwFlags,<BR>
PrimoSDK_CreateWmaReader pCallback</P>
<P CLASS="Code">);</P>
<P CLASS="SubHead_Sans11">Parameters</P>
<P CLASS="SubHead_SubSans11">Input</P>
<P CLASS="Code_Ital">dwFlags</P>
<P CLASS="Def_Field">Set to 0 (reserved for future use).</P>
<P CLASS="Code_Ital">pCallback</P>
<P CLASS="Def_Field">A pointer to a callback function of type PrimoSDK_CreateWmaReader.</P>
<P CLASS="SubHead_Sans11">Returned values</P>
<P CLASS="Code_Ital">PRIMOSDK_OK</P>
<P CLASS="Def_Field">The call completed successfully.</P>
<P CLASS="Code_Ital">PRIMOSDK_ERRORLOADING</P>
<P CLASS="Def_Field">Error when attempting to open the library.</P>
<P CLASS="Code_Ital">PRIMOSDK_FEATURE_NOT_SUPPORTED</P>
<P CLASS="Def_Field">A call was made to a function that is not available (this call requires PXSDK Plus package).</P>
<HR noshade SIZE=1 WIDTH="93%"><TABLE width="93%" align=center border=0><TBODY><col><col width=110><TR><TD CLASS="Heading4"><A ID="PrimoSDK_NewAudioPlaylist">PrimoSDK_NewAudioPlaylist</A></TD><TD class="IndentSansVisited">go: &nbsp;<A HRef="#chapter">top</A> &nbsp; &nbsp;| &nbsp; &nbsp;<A HRef="#WMA Playlists and DRM">section</A></TD></TR></TBODY></TABLE>
<P CLASS="IndentSerif">PrimoSDK_NewAudioPlaylist initiates the building of a structure for an Audio CD image that can support Windows Media Digital Rights Management when using <SPAN CLASS="Courier_New_Inline">.WMA </SPAN>source files (see <A HREF="PS_Guide_6.htm#Audio CD Workflow"><SPAN CLASS="Arial_Inline"><B>Audio CD Workflow</B></SPAN></A>). The structure is subsequently populated with audio tracks (see <A HREF="#PrimoSDK_AddAudioTrackEx">PrimoSDK_AddAudioTrackEx</A> or <A HREF="PS_Guide_6.htm#PrimoSDK_AddAudioTrack">PrimoSDK_AddAudioTrack</A>), at which point it may be written to a disc in the drive specified with <I>pdwUnits</I>.<BR>
<BR>
<B>NOTES</B>:<BR>
<B>&#187;</B> An Audio CD structure may also be created with <A HREF="PS_Guide_6.htm#PrimoSDK_NewAudio">PrimoSDK_NewAudio</A> if support is not needed for Windows Media Digital Rights Management when using <SPAN CLASS="Courier_New_Inline">.WMA </SPAN>source files.<BR>
<B>&#187;</B> To record an Audio CD track-by-track without first building a structure for the disc, see <A HREF="PS_Guide_6.htm#PrimoSDK_WriteAudioTrack">PrimoSDK_WriteAudioTrack</A>.</P>
<P CLASS="SubHead_Sans11">Syntax</P>
<P CLASS="Code">DWORD WINAPI PrimoSDK_NewAudioPlaylist (</P>
<P CLASS="Code_Indent">DWORD dwHandle,<BR>
PDWORD pdwUnits</P>
<P CLASS="Code">);</P>
<P CLASS="SubHead_Sans11">Parameters</P>
<P CLASS="SubHead_SubSans11">Input</P>
<P CLASS="Code_Ital">dwHandle </P>
<P CLASS="Def_Field">A DWORD specifying the operation&#39;s handle (see <A HREF="#PrimoSDK_GetHandle">PrimoSDK_GetHandle</A>).</P>
<P CLASS="SubHead_SubSans11">Input&#47;Output</P>
<P CLASS="Code_Ital">pdwUnits</P>
<P CLASS="Def_Field">A pointer to a DWORD vector identifying the destination drives by drive letter and&#47;or SCSI Host&#47;ID&#47;LUN triple (see PrimoSDK_UnitInfo for the internal DWORD format).</P>
<P CLASS="SubHead_Sans11">Returned values</P>
<P CLASS="Code_Ital">PRIMOSDK_OK</P>
<P CLASS="Def_Field">The call completed successfully.</P>
<P CLASS="Code_Ital">PRIMOSDK_CMDSEQUENCE</P>
<P CLASS="Def_Field">PrimoSDK is not yet initialized.</P>
<P CLASS="Code_Ital">PRIMOSDK_BADUNIT</P>
<P CLASS="Def_Field">A unit specified with <I>pdwUnit</I> does not exist.</P>
<P CLASS="Code_Ital">PRIMOSDK_NOTREADY</P>
<P CLASS="Def_Field">A unit is not ready.
</P>
<P CLASS="Code_Ital">PRIMOSDK_INVALIDMEDIUM</P>
<P CLASS="Def_Field">One or more target discs is not a blank CD-R or CD-RW.</P>
<P CLASS="Code_Ital">PRIMOSDK_BADHANDLE</P>
<P CLASS="Def_Field"><I>dwHandle</I> is not a valid handle.</P>
<P CLASS="Code_Ital">PRIMOSDK_INTERR</P>
<P CLASS="Def_Field">An internal error occured.</P>
<HR noshade SIZE=1 WIDTH="93%"><TABLE width="93%" align=center border=0><TBODY><col><col width=110><TR><TD CLASS="Heading4"><A ID="PrimoSDK_CheckAudioPlaylist">PrimoSDK_CheckAudioPlaylist</A></TD><TD class="IndentSansVisited">go: &nbsp;<A HRef="#chapter">top</A> &nbsp; &nbsp;| &nbsp; &nbsp;<A HRef="#WMA Playlists and DRM">section</A></TD></TR></TBODY></TABLE>
<P CLASS="IndentSerif">PrimoSDK_CheckAudioPlaylist checks an Audio CD structure that has been created with <A HREF="#PrimoSDK_NewAudioPlaylist">PrimoSDK_NewAudioPlaylist</A> to determine the Digital Rights Management (DRM) status of each playlist entry that has been added to the structure with <A HREF="#PrimoSDK_AddAudioTrackEx">PrimoSDK_AddAudioTrackEx</A> or <A HREF="PS_Guide_6.htm#PrimoSDK_AddAudioTrack">PrimoSDK_AddAudioTrack</A>. The results of the check are output with an array pointed to by the parameter <I>pdwResults</I>. If the result for a given entry is PRIMOSDK_OK then the track referenced by that entry may be included when the structure is written to disc with <A HREF="PS_Guide_6.htm#PrimoSDK_WriteAudio">PrimoSDK_WriteAudio</A>. Alternatively, a result of PRIMOSDK_PROTECTEDWMA indicates that a given entry may not be included.<BR>
<BR>
<B>NOTE</B>: An error will result in PrimoSDK_WriteAudio if an attempt is made to write an Audio CD structure for which any element in the array <I>pdwResults</I> is output as PRIMOSDK_PROTECTEDWMA. To write the structure without the protected track(s), delete the structure with <A HREF="PS_Guide_6.htm#PrimoSDK_CloseAudio">PrimoSDK_CloseAudio</A>, then create a new structure with PrimoSDK_NewAudioPlaylist.</P>
<P CLASS="SubHead_Sans11">Syntax</P>
<P CLASS="Code">DWORD WINAPI PrimoSDK_CheckAudioPlaylist ( </P>
<P CLASS="Code_Indent">DWORD dwHandle, <BR>
DWORD dwBufferSizeBytes, <BR>
PDWORD pdwResults</P>
<P CLASS="Code">);</P>
<P CLASS="SubHead_Sans11">Parameters</P>
<P CLASS="SubHead_SubSans11">Input</P>
<P CLASS="Code_Ital">dwHandle </P>
<P CLASS="Def_Field">A DWORD specifying the operation&#39;s handle (see <A HREF="PS_Guide_6.htm#PrimoSDK_GetHandle">PrimoSDK_GetHandle</A>), which must have the same value as in the PrimoSDK_NewAudioPlaylist call with which the Audio CD structure was created.</P>
<P CLASS="Code_Ital">dwBufferSizeBytes </P>
<P CLASS="Def_Field">The buffer size of pdwResults (normally the size of DWORD times the number of entries in the playlist).</P>
<P CLASS="Code_Ital">pdwResults </P>
<P CLASS="Def_Field">A pointer to an array of DWORDs in which each DWORD represents the result for each entry in the playlist. Possible results are PRIMOSDK_OK an entry with no DRM restrictions and PRIMOSDK_PROTECTEDWMA for a DRM-protected file.</P>
<P CLASS="SubHead_Sans11">Returned values</P>
<P CLASS="Code_Ital">PRIMOSDK_OK </P>
<P CLASS="Def_Field">The call completed successfully, and none of the files in the playlist is protected.</P>
<P CLASS="Code_Ital">PRIMOSDK_CMDSEQUENCE </P>
<P CLASS="Def_Field">PrimoSDK is not yet initialized, or no Audio CD structure has been started.</P>
<P CLASS="Code_Ital">PRIMOSDK_PROTECTEDWMA </P>
<P CLASS="Def_Field">One of the files in the playlist is protected.</P>
<P CLASS="Code_Ital">PRIMOSDK_BADHANDLE </P>
<P CLASS="Def_Field"><I>dwHandle</I> is not a valid handle.</P>
<P CLASS="Code_Ital">PRIMOSDK_INTERR </P>
<P CLASS="Def_Field">An internal error occured.</P>
<HR SIZE=2 WIDTH="93%"><TABLE width="93%" align=center border=0><TBODY><col><col width=50><TR><TD CLASS="Heading2"><A ID="Track Management">7.2 &nbsp;Track Management</A></TD><TD class="IndentSansVisited">go: &nbsp;<A HRef="#chapter">top</A></TD></TR></TBODY></TABLE>
<P CLASS="IndentSerif">This section covers the following calls:</P>
<P CLASS="Code"><A HREF="#PrimoSDK_AddAudioTrackEx">PrimoSDK_AddAudioTrackEx</A>, <A HREF="#PrimoSDK_AddAudioStream">PrimoSDK_AddAudioStream</A>, <A HREF="#PrimoSDK_AddAudioEffect">PrimoSDK_AddAudioEffect</A>, <A HREF="#PrimoSDK_WriteAudioTrackStream">PrimoSDK_WriteAudioTrackStream</A>, <A HREF="#PrimoSDK_GetAudioTrackInfo">PrimoSDK_GetAudioTrackInfo</A>, <A HREF="#PrimoSDK_GetISRC">PrimoSDK_GetISRC</A></P>
<P CLASS="IndentSerif">These calls are used to add tracks to an Audio CD data structure, to add audio effects to tracks, and to get information about tracks.</P>
<HR noshade SIZE=1 WIDTH="93%"><TABLE width="93%" align=center border=0><TBODY><col><col width=110><TR><TD CLASS="Heading4"><A ID="PrimoSDK_AddAudioTrackEx">PrimoSDK_AddAudioTrackEx</A></TD><TD class="IndentSansVisited">go: &nbsp;<A HRef="#chapter">top</A> &nbsp; &nbsp;| &nbsp; &nbsp;<A HRef="#Track Management">section</A></TD></TR></TBODY></TABLE>
<P CLASS="IndentSerif">PrimoSDK_AddAudioTrackEx adds to an Audio CD structure a track whose source is a file. The structure is indentified by the parameter <I>dwHandle</I>, which must have the same value as in the call with which the structure was created (see <A HREF="PS_Guide_6.htm#PrimoSDK_NewAudio">PrimoSDK_NewAudio</A>). As outlined in <A HREF="PS_Guide_6.htm#Audio CD Images"><SPAN CLASS="Arial_Inline"><B>Audio CD Images</B></SPAN></A>, after the structure is populated with tracks it may be written to a disc, with the tracks sequenced in the order they were added.<BR>
<BR>
The audio file to add to the Audio CD structure is specified with <I>szTrack</I>. If the PrimoSDK DLL is PrimoSDK.DLL, this file must be a Wave (<SPAN CLASS="Courier_New_Inline">.WAV</SPAN>) file. If the PrimoSDK DLL is PXSDKPLS.DLL, the file may be in Wave (<SPAN CLASS="Courier_New_Inline">.WAV</SPAN>), MPEG-1 Layer 3 (<SPAN CLASS="Courier_New_Inline">.mp3</SPAN>), or Windows Media Audio (<SPAN CLASS="Courier_New_Inline">.wma</SPAN>) format.<BR>
<BR>
The pregap for the track will be the sum of the values specified with <I>dwPregapAudio</I> and <I>dwPreGapSilence</I>; if both of these parameter specify zero duration there will be no pregap. Extended pregap (greater than 225 sectors) is not supported.<BR>
<BR>
<I>dwFlags</I> is used to set the track&#39;s emphasis and copyright information, while <I>pISRC</I> assigns the track&#39;s identifying ISRC code. When the call executes, the size in sectors of the added track is output with <I>pdwSize</I>.<BR>
<BR>
PrimoSDK_AddAudioTrackEx  also allows the setting of index points, which are locations within a track that may be navigated to directly on CD players supporting the index feature of the Red Book (CD-Audio) specification. Index points may be specified with the array pointed to by <I>pdwIndexArray</I>; each DWORD in the array gives a sector offset from the end of the pregap. Because index point 0 is always the start of the pregap and point 1 is always the end of the pregap, the array begins with point 2 (e.g. pdwIndexArray[0] = sector offset of index point 2, pdwIndexArray[1] = sector offset of index point 3, etc.). The total number of elements in the array (98 maximum) is specified with <I>dwIndexCount</I>. <BR>
<BR>
<B>NOTES:<BR>
&#187;</B> This call is a fuller-featured alternative to <A HREF="PS_Guide_6.htm#PrimoSDK_AddAudioTrack">PrimoSDK_AddAudioTrack</A>.<BR>
<B>&#187;</B> To add a track whose source is a stream provided by the host application (rather than a file specified with <I>szTrack</I>), see <A HREF="#PrimoSDK_AddAudioStream">PrimoSDK_AddAudioStream</A>.<BR>
<B>&#187; </B>Tracks specified with this call and with PrimoSDK_AddAudioStream may be intermingled in an Audio CD structure.<BR>
<B>&#187;</B> To record a track to an Audio CD Track-at-Once (without first building a structure for the entire disc), see <A HREF="PS_Guide_6.htm#PrimoSDK_WriteAudioTrack">PrimoSDK_WriteAudioTrack</A>.</P>
<P CLASS="SubHead_Sans11">Syntax</P>
<P CLASS="Code">DWORD WINAPI PrimoSDK_AddAudioTrackEx (</P>
<P CLASS="Code_Indent">DWORD dwHandle,<BR>
PBYTE szTrack,<BR>
DWORD dwPreGapSilence,<BR>
DWORD dwPreGapAudio,<BR>
DWORD dwFlags,<BR>
PDWORD pdwSize,<BR>
PBYTE pISRC,<BR>
DWORD dwIndexCount,<BR>
PDWORD pdwIndexArray</P>
<P CLASS="Code">);</P>
<P CLASS="SubHead_Sans11">Parameters</P>
<P CLASS="SubHead_SubSans11">Input</P>
<P CLASS="Code_Ital">dwHandle</P>
<P CLASS="Def_Field">A DWORD specifying the operation&#39;s handle (see <A HREF="PS_Guide_6.htm#PrimoSDK_GetHandle">PrimoSDK_GetHandle</A>), which must have the same value as in the PrimoSDK_NewAudio call with which the Audio CD structure was created.</P>
<P CLASS="Code_Ital">szTrack</P>
<P CLASS="Def_Field">A pointer to a BYTE specifying the complete path of the audio source file for the track.</P>
<P CLASS="Code_Ital">dwPreGapSilence</P>
<P CLASS="Def_Field">A DWORD specifying the number of sectors or frames in the track&#39;s pregap that contain silence.</P>
<P CLASS="Code_Ital">dwPreGapAudio</P>
<P CLASS="Def_Field">A DWORD specifying the number of sectors or frames in the track&#39;s pregap that contain audio.</P>
<P CLASS="Code_Ital"><BR>
dwFlags</P>
<P CLASS="Def_Field">A DWORD in which all of the following that apply are ORed together:<BR>
- PRIMOSDK_EMPHASIS to enable emphasis recording;<BR>
- PRIMOSDK_COPYRIGHT to set the copyright bit.</P>
<P CLASS="Code_Ital">pISRC</P>
<P CLASS="Def_Field">A pointer to a BYTE specifying the International Standard Recording Code (ISRC) that is to be assigned to the track.</P>
<P CLASS="Code_Ital">dwIndexCount</P>
<P CLASS="Def_Field">A DWORD specifying the number of track indices (up to 98) in the array specified with <I>pdwIndexArray</I>.</P>
<P CLASS="Code_Ital">pdwIndexArray</P>
<P CLASS="Def_Field">A pointer to an array of DWORDs, each of which specifies the location of one index point in the track (starting with index point 2) as an offset from the end of the pregap.</P>
<P CLASS="SubHead_SubSans11">Output</P>
<P CLASS="Code_Ital">pdwSize</P>
<P CLASS="Def_Field">A pointer to the DWORD that is to be filled in with the size in sectors of the file specified with <I>szTrack</I>.</P>
<P CLASS="SubHead_Sans11">Returned values</P>
<P CLASS="Code_Ital">PRIMOSDK_OK </P>
<P CLASS="Def_Field">The call completed successfully.</P>
<P CLASS="Code_Ital">PRIMOSDK_BADHANDLE</P>
<P CLASS="Def_Field"><I>dwHandle</I> is not a valid handle.</P>
<P CLASS="Code_Ital">PRIMOSDK_INTERR</P>
<P CLASS="Def_Field">An internal error occured.</P>
<P CLASS="Code_Ital">PRIMOSDK_FEATURE_DISABLED</P>
<P CLASS="Def_Field">This function is not enabled under the license covering this installation of PrimoSDK.</P>
<HR noshade SIZE=1 WIDTH="93%"><TABLE width="93%" align=center border=0><TBODY><col><col width=110><TR><TD CLASS="Heading4"><A ID="PrimoSDK_AddAudioStream">PrimoSDK_AddAudioStream</A></TD><TD class="IndentSansVisited">go: &nbsp;<A HRef="#chapter">top</A> &nbsp; &nbsp;| &nbsp; &nbsp;<A HRef="#Track Management">section</A></TD></TR></TBODY></TABLE>
<P CLASS="IndentSerif">PrimoSDK_AddAudioStream adds to an Audio CD structure a track whose source is a stream provided directly by the host application. This allows DRM-enabled host applications to decode encrypted music on-the-fly and pass the resulting stream to the writing engine without first creating an unencrypted file, thereby making it more difficult for the content to be intercepted by end-users.<BR>
<BR>
The structure to which the track is added is indentified by the parameter <I>dwHandle</I>, which must have the same value as in the call with which the structure was created (see <A HREF="PS_Guide_6.htm#PrimoSDK_NewAudio">PrimoSDK_NewAudio</A>). As outlined in <A HREF="PS_Guide_6.htm#Audio CD Images"><SPAN CLASS="Arial_Inline"><B>Audio CD Images</B></SPAN></A>, after the structure is populated with tracks it may be written to a disc, with the tracks sequenced in the order they were added.<BR>
<BR>
The audio stream, which must be stereo 16-bit&#47;44.1KHz PCM, is provided by the host application to buffers created via the callback function pointed to by <I>pFillerFn</I>, which is defined as follows:</P>
<P CLASS="Code">typedef DWORD (*PrimoSDK_StreamCallback)(PBYTE pBuffer, DWORD dwBytesRequested, PDWORD pdwBytesWritten, PVOID pContext); </P>
<P CLASS="IndentSerif">This callback is called during a write operation (see <A HREF="#PrimoSDK_WriteAudioEx">PrimoSDK_WriteAudioEx</A>) when the engine is ready to accept data to be written to the CD for the track defined by this call. The call also provides for a value, passed to the callback function with <I>pContent</I>, that may be used to identify which stream data is being requested.<BR>
<BR>
The amount of disc space (in sectors) that will be required for the added track is specified with <I>dwSize</I>, while the track&#39;s pregap is specified with <I>dwPregap</I>.<BR>
<BR>
<B>NOTES:</B><BR>
<B>&#187;</B> To add a track whose source is a file rather than a stream provided by the host application, see <A HREF="#PrimoSDK_AddAudioTrackEx">PrimoSDK_AddAudioTrackEx</A>. <BR>
<B>&#187; </B>Tracks specified with this call and with PrimoSDK_AddAudioTrackEx may be intermingled in an Audio CD structure.<BR>
<B>&#187;</B> To record a track to an Audio CD Track-at-Once (without first building a structure for the entire disc), see <A HREF="PS_Guide_6.htm#PrimoSDK_WriteAudioTrack">PrimoSDK_WriteAudioTrack</A>.<BR>
<B>&#187;</B> This function is supported in PrimoSDK version 2.0 or higher.</P>
<P CLASS="SubHead_Sans11">Syntax</P>
<P CLASS="Code">DWORD WINAPI PrimoSDK_AddAudioStream(</P>
<P CLASS="Code_Indent">DWORD dwHandle,<BR>
PrimoSDK_StreamCallback pFillerFn,<BR>
PVOID pContext,<BR>
DWORD dwPreGap,<BR>
DWORD dwSize</P>
<P CLASS="Code">);</P>
<P CLASS="SubHead_Sans11">Parameters</P>
<P CLASS="SubHead_SubSans11">Input</P>
<P CLASS="Code_Ital">dwHandle</P>
<P CLASS="Def_Field">A DWORD specifying the operation&#39;s handle (see <A HREF="PS_Guide_6.htm#PrimoSDK_GetHandle">PrimoSDK_GetHandle</A>).</P>
<P CLASS="Code_Ital">pFillerFn</P>
<P CLASS="Def_Field">A pointer to a PrimoSDK_StreamCallback function, which fills buffers with audio data to be written to the CD. </P>
<P CLASS="Code_Ital">pContext</P>
<P CLASS="Def_Field">A value, passed to the callback function, used to identify which stream data is being requested. PrimoSDK itself does not use this parameter.</P>
<P CLASS="Code_Ital">dwPreGap</P>
<P CLASS="Def_Field">A DWORD specifying the track&#39;s pregap in sectors. The entire pregap is silent. The first track (first song) will always have a pregap of 150 blocks (regardless of the value passed with this parameter).</P>
<P CLASS="Code_Ital">dwSize</P>
<P CLASS="Def_Field">A DWORD specifying the number of sectors that will be required to record the audio for this track onto the destination disc.</P>
<P CLASS="SubHead_Sans11">Returned values</P>
<P CLASS="Code_Ital">PRIMOSDK_OK</P>
<P CLASS="Def_Field">The call completed successfully.</P>
<P CLASS="Code_Ital">PRIMOSDK_BADHANDLE</P>
<P CLASS="Def_Field"><I>dwHandle</I> is not a valid handle.</P>
<P CLASS="Code_Ital">PRIMOSDK_FEATURE_DISABLED</P>
<P CLASS="Def_Field">This function is not enabled under the license covering this installation of PrimoSDK.</P>
<HR noshade SIZE=1 WIDTH="93%"><TABLE width="93%" align=center border=0><TBODY><col><col width=110><TR><TD CLASS="Heading4"><A ID="PrimoSDK_AddAudioEffect">PrimoSDK_AddAudioEffect</A></TD><TD class="IndentSansVisited">go: &nbsp;<A HRef="#chapter">top</A> &nbsp; &nbsp;| &nbsp; &nbsp;<A HRef="#Track Management">section</A></TD></TR></TBODY></TABLE>
<P CLASS="IndentSerif">PrimoSDK_AddAudioEffect specifies an effect to apply to an audio track that has been added to an Audio CD structure with <A HREF="#PrimoSDK_AddAudioTrackEx">PrimoSDK_AddAudioTrackEx</A> (or <A HREF="PS_Guide_6.htm#PrimoSDK_AddAudioTrack">PrimoSDK_AddAudioTrack</A>). The effect must be specified before the track is written to disc with <A HREF="PS_Guide_6.htm#PrimoSDK_WriteAudio">PrimoSDK_WriteAudio</A>.<BR>
<BR>
The structure in which the track exists is indentified by the parameter <I>dwHandle</I>, which must have the same value as in the call with which the structure was created (see <A HREF="PS_Guide_6.htm#PrimoSDK_NewAudio">PrimoSDK_NewAudio</A>). The number of the track is specified with <I>dwTrack</I>. Tracks are numbered, starting with 1, based on the order in which they are added.<BR>
<BR>
The type of effect to be applied by the call is specified with <I>dwEffectType</I>. The only currently-defined value for this parameter is PRIMOSDK_NORMALIZE, which sets the call to scale<I> </I>the amplitude of every audio sample in the track to a percentage of the amplitude of the corresponding sample in the source file. The percentage is expressed as a number from 0 to 10000 (100.00 percent of the amplitude in the source file). <BR>
<BR>
<B>NOTE</B>: Some effects require parameter information that must be retrieved with <A HREF="#PrimoSDK_GetAudioTrackInfo">PrimoSDK_GetAudioTrackInfo</A> before using this call.</P>
<P CLASS="SubHead_Sans11">Syntax</P>
<P CLASS="Code">DWORD WINAPI PrimoSDK_AddAudioEffect(</P>
<P CLASS="Code_Indent">DWORD dwHandle,<BR>
DWORD dwTrack,<BR>
DWORD dwEffectType,<BR>
DWORD dwParameterDwords,<BR>
PDWORD pdwParameters</P>
<P CLASS="Code">);</P>
<P CLASS="SubHead_Sans11">Parameters</P>
<P CLASS="SubHead_SubSans11">Input</P>
<P CLASS="Code_Ital">dwHandle</P>
<P CLASS="Def_Field">A DWORD specifying the operation&#39;s handle (see <A HREF="PS_Guide_6.htm#PrimoSDK_GetHandle">PrimoSDK_GetHandle</A>), which must have the same value as in the PrimoSDK_NewAudio call with which the Audio CD structure was created.</P>
<P CLASS="Code_Ital">dwTrack</P>
<P CLASS="Def_Field">A DWORD specifying the number of the audio track to which an effect is to be applied.</P>
<P CLASS="Code_Ital">dwEffectType</P>
<P CLASS="Def_Field">A DWORD specifying the type of the effect to be applied (currently PRIMOSDK_NORMALIZE only).<BR>
</P>
<P CLASS="Code_Ital">dwParameterDwords</P>
<P CLASS="Def_Field">A DWORD specifying the size (in DWORDs) to allocate for the <I>pdwParameters</I> array. If <I>dwEffectType</I> is PRIMOSDK_NORMALIZE, pass as 2.</P>
<P CLASS="Code_Ital">pdwParameters</P>
<P CLASS="Def_Field">A pointer to an array of DWORDs, each of which is a parameter for the effect type specified with <I>dwEffectType</I>. If <I>dwEffectType</I> is PRIMOSDK_NORMALIZE, the DWORDs are used as follows:<BR>
- [0]: The peak level for this track as returned from <A HREF="#PrimoSDK_GetAudioTrackInfo">PrimoSDK_GetAudioTrackInfo</A> (0 - 10000).<BR>
- [1]: The percent of the source file amplitude to which the track amplitude is to be scaled (10000 = 100.00%).</P>
<P CLASS="SubHead_Sans11">Returned values</P>
<P CLASS="Code_Ital">PRIMOSDK_OK</P>
<P CLASS="Def_Field">The call completed successfully.</P>
<P CLASS="Code_Ital">PRIMOSDK_CMDSEQUENCE</P>
<P CLASS="Def_Field">PrimoSDK is not yet initialized, or no Audio CD structure has been started.</P>
<P CLASS="Code_Ital">PRIMOSDK_BADPARAM</P>
<P CLASS="Def_Field">The value of one or more parameters is invalid.</P>
<P CLASS="Code_Ital">PRIMOSDK_BADHANDLE</P>
<P CLASS="Def_Field"><I>dwHandle</I> is not a valid handle.</P>
<HR noshade SIZE=1 WIDTH="93%"><TABLE width="93%" align=center border=0><TBODY><col><col width=110><TR><TD CLASS="Heading4"><A ID="PrimoSDK_WriteAudioTrackStream">PrimoSDK_WriteAudioTrackStream</A></TD><TD class="IndentSansVisited">go: &nbsp;<A HRef="#chapter">top</A> &nbsp; &nbsp;| &nbsp; &nbsp;<A HRef="#Track Management">section</A></TD></TR></TBODY></TABLE>
<P CLASS="IndentSerif">PrimoSDK_WriteAudioTrackStream writes a single track from a stream to one or more discs in the recorders specified with <I>pdwUnits</I>. Unlike <A HREF="#PrimoSDK_WriteAudioEx">PrimoSDK_WriteAudioEx</A> (which records in Disc-at-Once mode), the recording does not require advance creation of an Audio CD structure as described in <A HREF="PS_Guide_6.htm#Audio CD Images"><SPAN CLASS="Arial_Inline"><B>Audio CD Images</B></SPAN></A>. Instead, it is carried out in Track-at-Once (TAO) mode, with one track added each time the function is called. The destination disc(s) may be blank (if this is the first track added) or already contain one or more audio tracks.<BR>
 <BR>
The audio data to write to the Audio CD is supplied by the callback function specified with <I>pFillerFn</I>. The size of the data is specified with <I>dwSize</I>, and the speed at which to record it is specified with <I>dwSpeed</I>. User data to be passed back when the callback is called may be provided with <I>pContext</I>; this data may be used to identify which stream data is being requested.<BR>
<BR>
If this track is the last to be added to the CD, the parameter <I>dwFlags</I> should include the PRIMOSDK_CLOSEDISC flag so that the disc will be finalized, after which it will be playable in a CD-ROM drive or a consumer CD-Audio player. If the intent is to add additional tracks later; then that flag should not be set. <I>dwFlags</I> also determines whether or not the drives are in &quot;test write&quot; mode for this operation.<BR>
<BR>
<B>NOTE</B>: This call is used as part of the recommended write operation sequence described in <A HREF="PS_Guide_6.htm#Drive Control Sequence"><SPAN CLASS="Arial_Inline"><B>Drive Control Sequence</B></SPAN></A>.</P>
<P CLASS="SubHead_Sans11">Syntax</P>
<P CLASS="Code">DWORD WINAPI PrimoSDK_WriteAudioTrackStream(</P>
<P CLASS="Code_Indent">DWORD dwHandle,<BR>
PDWORD pdwUnits,<BR>
PrimoSDK_StreamCallback pFillerFn,<BR>
PVOID pContext,<BR>
DWORD dwSize,<BR>
DWORD dwFlags,<BR>
DWORD dwSpeed</P>
<P CLASS="Code">);</P>
<P CLASS="SubHead_Sans11">Parameters</P>
<P CLASS="SubHead_SubSans11">Input</P>
<P CLASS="Code_Ital">dwHandle</P>
<P CLASS="Def_Field">A DWORD specifying the operation&#39;s handle (see <A HREF="PS_Guide_6.htm#PrimoSDK_GetHandle">PrimoSDK_GetHandle</A>).</P>
<P CLASS="Code_Ital">pFillerFn</P>
<P CLASS="Def_Field">A pointer to the function to call to fill buffers with audio that is to be written to the CD. The audio must be stereo (2 channel), 44100Hz sample rate at 16-bits per sample.</P>
<P CLASS="Code_Ital">pContext</P>
<P CLASS="Def_Field">An object whose value will be passed to the callback function by PrimoSDK when the callback is called.</P>
<P CLASS="Code_Ital">dwSize</P>
<P CLASS="Def_Field">A DWORD specifying the size in sectors of the audio for this track.</P>
<P CLASS="Code_Ital">dwFlags</P>
<P CLASS="Def_Field">A DWORD in which all of the following that apply are ORed together:<BR>
- PRIMOSDK_WRITE to make a real recording, or PRIMOSDK_TEST to run a test;<BR>
- PRIMOSDK_BURNPROOF to enable BURN-Proof (buffer underrun protection) if available on the destination drive;<BR>
- PRIMOSDK_CLOSEDISC to close the disc to further writing (recommended for most Audio CD discs).</P>
<P CLASS="Code_Ital">dwSpeed</P>
<P CLASS="Def_Field">A DWORD specifying the recording speed as one of the following:<BR>
- PRIMOSDK_MAX for the highest speed supported by both the destination drive and destination media;<BR>
- n for the actual number of the desired speed (e.g. 8 for 8x);<BR>
- PRIMOSDK_BEST for drives that support Adjustable Write Speed. If the drive does not support AWS, the speed will revert to PRIMOSDK_MAX.</P>
<P CLASS="SubHead_SubSans11">Input&#47;Output</P>
<P CLASS="Code_Ital">pdwUnits</P>
<P CLASS="Def_Field">A pointer to a DWORD vector identifying by drive letter and&#47;or SCSI Host&#47;ID&#47;LUN triple the drives containing the discs to which the audio track is to be written (see <A HREF="PS_Guide_6.htm#PrimoSDK_UnitInfo">PrimoSDK_UnitInfo</A> for the internal DWORD format). The vector is terminated by 0xFFFFFFFF.</P>
<P CLASS="SubHead_Sans11">Returned values</P>
<P CLASS="Code_Ital">PRIMOSDK_OK</P>
<P CLASS="Def_Field">The call completed successfully.</P>
<P CLASS="Code_Ital">PRIMOSDK_CMDSEQUENCE</P>
<P CLASS="Def_Field">PrimoSDK is not yet initialized, or no Audio CD structure has been started, or the Audio CD is empty.</P>
<P CLASS="Code_Ital">PRIMOSDK_BADPARAM</P>
<P CLASS="Def_Field">The value of one or more parameters is invalid.</P>
<P CLASS="Code_Ital">PRIMOSDK_NOTREADY</P>
<P CLASS="Def_Field">One or more units are not ready.</P>
<P CLASS="Code_Ital">PRIMOSDK_ITSADEMO</P>
<P CLASS="Def_Field">The operation exceeds the limits allowed by the Demo version of PrimoSDK.</P>
<P CLASS="Code_Ital">PRIMOSDK_BADHANDLE</P>
<P CLASS="Def_Field"><I>dwHandle</I> is not a valid handle.</P>
<P CLASS="Code_Ital">PRIMOSDK_INTERR</P>
<P CLASS="Def_Field">An internal error occured.</P>
<HR noshade SIZE=1 WIDTH="93%"><TABLE width="93%" align=center border=0><TBODY><col><col width=110><TR><TD CLASS="Heading4"><A ID="PrimoSDK_GetAudioTrackInfo">PrimoSDK_GetAudioTrackInfo</A></TD><TD class="IndentSansVisited">go: &nbsp;<A HRef="#chapter">top</A> &nbsp; &nbsp;| &nbsp; &nbsp;<A HRef="#Track Management">section</A></TD></TR></TBODY></TABLE>
<P CLASS="IndentSerif">PrimoSDK_GetAudioTrackInfo retrieves information about audio in the source file of an audio track that has been added to an Audio CD structure with <A HREF="#PrimoSDK_AddAudioTrackEx">PrimoSDK_AddAudioTrackEx</A> (or <A HREF="PS_Guide_6.htm#PrimoSDK_AddAudioTrack">PrimoSDK_AddAudioTrack</A>). The information retrieved from this call may be used when modifying the track&#39;s audio using <A HREF="#PrimoSDK_AddAudioEffect">PrimoSDK_AddAudioEffect</A> (before the track is written to disc with <A HREF="PS_Guide_6.htm#PrimoSDK_WriteAudio">PrimoSDK_WriteAudio</A>).<BR>
<BR>
The structure in which the track exists is indentified by the parameter <I>dwHandle</I>, which must have the same value as in the call with which the structure was created (see <A HREF="PS_Guide_6.htm#PrimoSDK_NewAudio">PrimoSDK_NewAudio</A>). The number of the track is specified with <I>dwTrack</I>. Tracks are numbered, starting with 1, based on the order in which they are added.<BR>
<BR>
The type of the information to be retrieved by the call is specified with <I>dwInfoType</I>. The only currently-defined value for this parameter is PRIMOSDK_PEAK, which sets the call to output (with <I>pdwResult</I>)<I> </I>the peak level of the audio in the source file, expressed as a number from 0 to 10000 (100.00 percent of the maximum possible level for the track). <BR>
<BR>
Depending on the duration of the source file, retrieving audio information may take some time, so the function does not always output information on the first call (instead returning PRIMOSDK_RUNNING). The following approach is recommended to handle this issue:</P>
<P CLASS="Code">while ((rc = PrimoSDK_GetAudioTrackInfo(<BR>
...)) == PRIMOSDK_RUNNING)<BR>
{</P>
<P CLASS="Code_Indent">&#47;&#47; sleep or peek message</P>
<P CLASS="Code">}<BR>
if (rc == PRIMOSDK_OK)<BR>
{</P>
<P CLASS="Code_Indent">&#47;&#47; info is valid</P>
<P CLASS="Code">}</P>
<P CLASS="SubHead_Sans11">Syntax</P>
<P CLASS="Code">DWORD WINAPI PrimoSDK_GetAudioTrackInfo(</P>
<P CLASS="Code_Indent">DWORD dwHandle,<BR>
DWORD dwTrack,<BR>
DWORD dwInfoType,<BR>
DWORD dwResultDwords,<BR>
PDWORD pdwResult</P>
<P CLASS="Code">);</P>
<P CLASS="SubHead_Sans11">Parameters</P>
<P CLASS="SubHead_SubSans11">Input</P>
<P CLASS="Code_Ital">dwHandle</P>
<P CLASS="Def_Field">A DWORD specifying the operation&#39;s handle (see <A HREF="PS_Guide_6.htm#PrimoSDK_GetHandle">PrimoSDK_GetHandle</A>), which must have the same value as in the PrimoSDK_NewAudio call with which the Audio CD structure was created.</P>
<P CLASS="Code_Ital">dwTrack</P>
<P CLASS="Def_Field">A DWORD specifying the number of the audio track for which information is to be retrieved.</P>
<P CLASS="Code_Ital">dwInfoType</P>
<P CLASS="Def_Field">A DWORD specifying the type of information to be retrieved (currently PRIMOSDK_PEAK only).</P>
<P CLASS="Code_Ital">dwResultDwords</P>
<P CLASS="Def_Field">A DWORD specifying the size (in DWORDs) allocated for the <I>pdwResult</I> array; must be at least 1.</P>
<P CLASS="SubHead_SubSans11">Output</P>
<P CLASS="Code_Ital">pdwResult</P>
<P CLASS="Def_Field">A pointer to the array of DWORDs that is to be filled in with the retrieved information.</P>
<P CLASS="SubHead_Sans11">Returned values</P>
<P CLASS="Code_Ital">PRIMOSDK_OK</P>
<P CLASS="Def_Field">The call completed successfully.</P>
<P CLASS="Code_Ital">PRIMOSDK_RUNNING</P>
<P CLASS="Def_Field">The operation is currently running (still calculating the requested information).</P>
<P CLASS="Code_Ital">PRIMOSDK_CMDSEQUENCE</P>
<P CLASS="Def_Field">PrimoSDK is not yet initialized or no Audio CD has been started.</P>
<P CLASS="Code_Ital">PRIMOSDK_BADPARAM</P>
<P CLASS="Def_Field">The value of one or more parameters is invalid.</P>
<P CLASS="Code_Ital">PRIMOSDK_BADHANDLE</P>
<P CLASS="Def_Field"><I>dwHandle</I> is not a valid handle.</P>
<P CLASS="Code_Ital">PRIMOSDK_FILEERROR</P>
<P CLASS="Def_Field">Primo cannot calculate the peaks in the specified audio file, possibly because the file is corrupt or invalid.</P>
<HR noshade SIZE=1 WIDTH="93%"><TABLE width="93%" align=center border=0><TBODY><col><col width=110><TR><TD CLASS="Heading4"><A ID="PrimoSDK_GetISRC">PrimoSDK_GetISRC</A></TD><TD class="IndentSansVisited">go: &nbsp;<A HRef="#chapter">top</A> &nbsp; &nbsp;| &nbsp; &nbsp;<A HRef="#Track Management">section</A></TD></TR></TBODY></TABLE>
<P CLASS="IndentSerif">PrimoSDK_GetISRC retrieves the International Standard Recording Code for a track on the Audio CD in the drive specified with the parameter <I>pdwUnit</I>. The track is specified with <I>dwTrack</I>, while the ISRC code is output with <I>pISRC</I>.</P>
<P CLASS="SubHead_Sans11">Syntax</P>
<P CLASS="Code">DWORD WINAPI PrimoSDK_GetISRC (</P>
<P CLASS="Code_Indent">DWORD dwHandle,<BR>
PDWORD pdwUnit,<BR>
DWORD dwTrack,<BR>
PBYTE pISRC</P>
<P CLASS="Code">);</P>
<P CLASS="SubHead_Sans11">Parameters</P>
<P CLASS="SubHead_SubSans11">Input</P>
<P CLASS="Code_Ital">dwHandle</P>
<P CLASS="Def_Field">A DWORD specifying the operation&#39;s handle (see <A HREF="PS_Guide_6.htm#PrimoSDK_GetHandle">PrimoSDK_GetHandle</A>).</P>
<P CLASS="Code_Ital">pdwUnit</P>
<P CLASS="Def_Field">A pointer to a DWORD identifying the unit by drive letter and&#47;or SCSI Host&#47;ID&#47;LUN triple (for the internal format of the DWORD, see <A HREF="PS_Guide_6.htm#PrimoSDK_UnitInfo">PrimoSDK_UnitInfo</A>).</P>
<P CLASS="Code_Ital">dwTrack</P>
<P CLASS="Def_Field">A DWORD specifying the track from which to retrieve the ISRC.</P>
<P CLASS="SubHead_SubSans11">Output</P>
<P CLASS="Code_Ital">pISRC</P>
<P CLASS="Def_Field">A pointer to a 12-byte buffer that is to be filled in with the ISRC information The buffer is not NULL terminated. If no ISRC information is available for the track, the buffer will be filled with 0.</P>
<P CLASS="SubHead_Sans11">Returned values</P>
<P CLASS="Code_Ital">PRIMOSDK_OK</P>
<P CLASS="Def_Field">The call completed successfully.</P>
<P CLASS="Code_Ital">PRIMOSDK_BADHANDLE </P>
<P CLASS="Def_Field"><I>dwHandle</I> is not a valid handle.</P>
<P CLASS="Code_Ital">PRIMOSDK_BADPARAM </P>
<P CLASS="Def_Field"><I>dwTrack</I> specifies an invalid track.</P>
<P CLASS="Code_Ital">PRIMOSDK_READERROR </P>
<P CLASS="Def_Field">The drive reports an error reading the ISRC.</P>
<P CLASS="Code_Ital">PRIMOSDK_FEATURE_DISABLED</P>
<P CLASS="Def_Field">This function is not enabled under the license covering this installation of PrimoSDK.</P>
<HR SIZE=2 WIDTH="93%"><TABLE width="93%" align=center border=0><TBODY><col><col width=50><TR><TD CLASS="Heading2"><A ID="Write to Disc">7.3 &nbsp;Write to Disc</A></TD><TD class="IndentSansVisited">go: &nbsp;<A HRef="#chapter">top</A></TD></TR></TBODY></TABLE>
<P CLASS="IndentSerif">This section covers the following call:</P>
<P CLASS="Code"><A HREF="#PrimoSDK_WriteAudioEx">PrimoSDK_WriteAudioEx</A></P>
<P CLASS="IndentSerif">This call is used to write an Audio CD structure to disc.</P>
<HR noshade SIZE=1 WIDTH="93%"><TABLE width="93%" align=center border=0><TBODY><col><col width=110><TR><TD CLASS="Heading4"><A ID="PrimoSDK_WriteAudioEx">PrimoSDK_WriteAudioEx</A></TD><TD class="IndentSansVisited">go: &nbsp;<A HRef="#chapter">top</A> &nbsp; &nbsp;| &nbsp; &nbsp;<A HRef="#Write to Disc">section</A></TD></TR></TBODY></TABLE>
<P CLASS="IndentSerif">PrimoSDK_WriteAudioEx writes an Audio CD structure in Disc-at-Once mode to one or more discs, either actually or in &quot;test write&quot; mode. As outlined in <A HREF="PS_Guide_6.htm#Audio CD Images"><SPAN CLASS="Arial_Inline"><B>Audio CD Images</B></SPAN></A>, this function is called after the structure is populated with tracks and CD Text information (if any).<BR>
<BR>
The structure is indentified by the parameter <I>dwHandle</I>, which must have the same value as in the call with which the structure was created (see <A HREF="PS_Guide_6.htm#PrimoSDK_NewAudio">PrimoSDK_NewAudio</A> or <A HREF="#PrimoSDK_NewAudioPlaylist">PrimoSDK_NewAudioPlaylist</A>). The drives on which the discs will be recorded are those specified with <I>pdwUnits</I> in that same PrimoSDK_NewAudio call. Each recorder must already contain a blank recordable&#47;rewritable disc (see <I>pdwMediumType</I> under <A HREF="PS_Guide_6.htm#PrimoSDK_DiscInfoEx">PrimoSDK_DiscInfoEx</A>).<BR>
<BR>
This function returns immediately and continues asynchronously. To check on or abort the operation, see <A HREF="PS_Guide_6.htm#PrimoSDK_RunningStatus">PrimoSDK_RunningStatus</A>. After PrimoSDK_RunningStatus reports that the operation has completed (successful or otherwise), this function may be called again to record additional passes of the image on fresh media. When no further passes are required, <A HREF="PS_Guide_6.htm#PrimoSDK_CloseAudio">PrimoSDK_CloseAudio</A> may be called to release the structure.<BR>
<BR>
<B>NOTES:<BR>
&#187;</B> This call is a fuller-featured alternative to <A HREF="PS_Guide_6.htm#PrimoSDK_WriteAudio">PrimoSDK_WriteAudio</A>.<BR>
<B>&#187; </B>This call is used as part of the recommended write operation sequence described in <A HREF="PS_Guide_6.htm#Drive Control Sequence"><SPAN CLASS="Arial_Inline"><B>Drive Control Sequence</B></SPAN></A>.<B> <BR>
&#187; </B>An error will result if an attempt is made to write an Audio CD structure that is a playlist (see <A HREF="#PrimoSDK_NewAudioPlaylist">PrimoSDK_NewAudioPlaylist</A>) containing a protected track (see <A HREF="#PrimoSDK_CheckAudioPlaylist">PrimoSDK_CheckAudioPlaylist</A>). To write the structure without the protected track(s), delete the structure with PrimoSDK_CloseAudio, then create a new structure with PrimoSDK_NewAudioPlaylist.<BR>
<B>&#187; </B>For normal audio discs, close the disc to further writing by passing PRIMOSDK_CLOSEDISC in <I>dwFlags</I>.<BR>
<B>&#187; </B>To record an Audio CD track-by-track rather than from a completed Audio CD structure, see <A HREF="PS_Guide_6.htm#PrimoSDK_WriteAudioTrack">PrimoSDK_WriteAudioTrack</A>.</P>
<P CLASS="SubHead_Sans11">Syntax</P>
<P CLASS="Code">DWORD WINAPI PrimoSDK_WriteAudioEx (</P>
<P CLASS="Code_Indent">DWORD dwHandle,<BR>
DWORD dwFlags,<BR>
DWORD dwSpeed,<BR>
PBYTE pMCN</P>
<P CLASS="Code">);</P>
<P CLASS="SubHead_Sans11">Parameters</P>
<P CLASS="SubHead_SubSans11">Input</P>
<P CLASS="Code_Ital">dwHandle </P>
<P CLASS="Def_Field">A DWORD specifying the operation&#39;s handle (see <A HREF="PS_Guide_6.htm#PrimoSDK_GetHandle">PrimoSDK_GetHandle</A>), which must have the same value as in the PrimoSDK_NewAudio call with which the Audio CD structure was created.</P>
<P CLASS="Code_Ital">dwFlags </P>
<P CLASS="Def_Field">A DWORD in which all of the following that apply are ORed together:<BR>
- PRIMOSDK_WRITE to make a real recording, or PRIMOSDK_TEST to run a test;<BR>
- PRIMOSDK_BURNPROOF to enable BURN-Proof (buffer underrun protection) if available on the destination drive;<BR>
- PRIMOSDK_CLOSEDISC to close the disc to further writing (recommended for most Audio CD discs).</P>
<P CLASS="Code_Ital">dwSpeed </P>
<P CLASS="Def_Field">A DWORD specifying the recording speed as one of the following:<BR>
- PRIMOSDK_MAX for the highest speed supported by both the destination drive and destination media;<BR>
- n for the actual number of the desired speed (e.g. 8 for 8x);<BR>
- PRIMOSDK_BEST for drives that support Adjustable Write Speed. If the drive does not support AWS, the speed will revert to PRIMOSDK_MAX.</P>
<P CLASS="Code_Ital">pMCN</P>
<P CLASS="Def_Field">A pointer to a BYTE specifying the Media Catalog Number (13 bytes will be BCD encoded to be placed into the Q channel).</P>
<P CLASS="SubHead_Sans11">Returned values</P>
<P CLASS="Code_Ital">PRIMOSDK_OK </P>
<P CLASS="Def_Field">The call completed successfully.</P>
<P CLASS="Code_Ital">PRIMOSDK_CMDSEQUENCE</P>
<P CLASS="Def_Field">PrimoSDK is not yet initialized, the Audio CD structure hasn&#39;t yet been started, or the Audio CD structure is empty.</P>
<P CLASS="Code_Ital">PRIMOSDK_BADPARAM</P>
<P CLASS="Def_Field">The parameters in the function are incorrect, or no drives have been specified with <I>pdwUnits</I> in PrimoSDK_NewAudio.</P>
<P CLASS="Code_Ital">PRIMOSDK_NOTREADY</P>
<P CLASS="Def_Field">One or more units are not ready.</P>
<P CLASS="Code_Ital">PRIMOSDK_NOSPACE</P>
<P CLASS="Def_Field">One or more of the media do not have enough free sectors.</P>
<P CLASS="Code_Ital">PRIMOSDK_ITSADEMO</P>
<P CLASS="Def_Field">The operation exceeds the limits allowed by the Demo version of PrimoSDK.</P>
<P CLASS="Code_Ital">PRIMOSDK_BADHANDLE</P>
<P CLASS="Def_Field"><I>dwHandle</I> is not a valid handle.</P>
<P CLASS="Code_Ital">PRIMOSDK_INTERR</P>
<P CLASS="Def_Field">An internal error occured</P>
<P CLASS="Code_Ital">PRIMOSDK_FEATURE_DISABLED</P>
<P CLASS="Def_Field">This function is not enabled under the license covering this installation of PrimoSDK.</P>
<HR SIZE=2 WIDTH="93%"><TABLE width="93%" align=center border=0><TBODY><col><col width=50><TR><TD CLASS="Heading2"><A ID="Playback Control">7.4 &nbsp;Playback Control</A></TD><TD class="IndentSansVisited">go: &nbsp;<A HRef="#chapter">top</A></TD></TR></TBODY></TABLE>
<P CLASS="IndentSerif">This section covers the following calls:</P>
<P CLASS="Code"><A HREF="#PrimoSDK_GetPositionAudio">PrimoSDK_GetPositionAudio</A>, <A HREF="#PrimoSDK_PlayAudio">PrimoSDK_PlayAudio</A>, <A HREF="#PrimoSDK_PauseResumeAudio">PrimoSDK_PauseResumeAudio</A>, <A HREF="#PrimoSDK_StopAudio">PrimoSDK_StopAudio</A></P>
<P CLASS="IndentSerif">These calls are used to control audio playback.</P>
<HR noshade SIZE=1 WIDTH="93%"><TABLE width="93%" align=center border=0><TBODY><col><col width=110><TR><TD CLASS="Heading4"><A ID="PrimoSDK_GetPositionAudio">PrimoSDK_GetPositionAudio</A></TD><TD class="IndentSansVisited">go: &nbsp;<A HRef="#chapter">top</A> &nbsp; &nbsp;| &nbsp; &nbsp;<A HRef="#Playback Control">section</A></TD></TR></TBODY></TABLE>
<P CLASS="IndentSerif">PrimoSDK_GetPositionAudio retrieves the current position (in sectors) of the Audio CD in the device specified with the parameter <I>pdwUnit</I>. The relative position is output with <I>pdwRelPosition</I>, while the absolute position is output with <I>pdwAbsPosition</I>.</P>
<P CLASS="SubHead_Sans11">Syntax</P>
<P CLASS="Code">DWORD WINAPI PrimoSDK_GetPositionAudio(</P>
<P CLASS="Code_Indent">DWORD dwHandle,<BR>
PDWORD pdwUnit,<BR>
PDWORD pdwRelPosition,<BR>
PDWORD pdwAbsPosition</P>
<P CLASS="Code">);</P>
<P CLASS="SubHead_Sans11">Parameters</P>
<P CLASS="SubHead_SubSans11">Input</P>
<P CLASS="Code_Ital">dwHandle</P>
<P CLASS="Def_Field">A DWORD specifying the operation&#39;s handle (see <A HREF="PS_Guide_6.htm#PrimoSDK_GetHandle">PrimoSDK_GetHandle</A>).</P>
<P CLASS="SubHead_SubSans11">Input&#47;Output</P>
<P CLASS="Code_Ital">pdwUnit</P>
<P CLASS="Def_Field">A pointer to a DWORD identifying the unit by drive letter and&#47;or SCSI Host&#47;ID&#47;LUN triple (for the internal format of the DWORD, see <A HREF="PS_Guide_6.htm#PrimoSDK_UnitInfo">PrimoSDK_UnitInfo</A>).</P>
<P CLASS="SubHead_SubSans11">Output</P>
<P CLASS="Code_Ital">pdwRelPosition</P>
<P CLASS="Def_Field">A pointer to a DWORD that is to be filled in with the CD&#39;s relative position in sectors.</P>
<P CLASS="Code_Ital">pdwAbsPosition</P>
<P CLASS="Def_Field">A pointer to a DWORD that is to be filled in with the CD&#39;s absolute position in sectors.</P>
<P CLASS="SubHead_Sans11">Returned values</P>
<P CLASS="Code_Ital">PRIMOSDK_OK</P>
<P CLASS="Def_Field">The call completed successfully.</P>
<P CLASS="Code_Ital">PRIMOSDK_CMDSEQUENCE</P>
<P CLASS="Def_Field">PrimoSDK is not yet initialized.</P>
<P CLASS="Code_Ital">PRIMOSDK_BADUNIT</P>
<P CLASS="Def_Field">The unit specified with <I>pdwUnit</I> does not exist.</P>
<P CLASS="Code_Ital">PRIMOSDK_SCSIERROR</P>
<P CLASS="Def_Field">A communication error occurred, or the command went in time-out.
</P>
<P CLASS="Code_Ital">PRIMOSDK_UNITERROR</P>
<P CLASS="Def_Field">The command returned a check condition (pSense, pASC, and pASCQ will point to the corresponding error triple).</P>
<P CLASS="Code_Ital">PRIMOSDK_BADHANDLE</P>
<P CLASS="Def_Field"><I>dwHandle</I> is not a valid handle.</P>
<P CLASS="Code_Ital">PRIMOSDK_INTERR</P>
<P CLASS="Def_Field">An internal error occured.</P>
<P CLASS="Code_Ital">PRIMOSDK_BADPARAM</P>
<P CLASS="Def_Field">The value of one or more parameters is invalid (e.g. pointers for the positions are NULL).</P>
<HR noshade SIZE=1 WIDTH="93%"><TABLE width="93%" align=center border=0><TBODY><col><col width=110><TR><TD CLASS="Heading4"><A ID="PrimoSDK_PlayAudio">PrimoSDK_PlayAudio</A></TD><TD class="IndentSansVisited">go: &nbsp;<A HRef="#chapter">top</A> &nbsp; &nbsp;| &nbsp; &nbsp;<A HRef="#Playback Control">section</A></TD></TR></TBODY></TABLE>
<P CLASS="IndentSerif">PrimoSDK_PlayAudio plays one or more sectors of audio data from the disc in the device specified with <I>pdwUnit</I>. The starting sector (logical block address) for playback is specified with <I>StartLba</I>. The number of sectors to play is specified with <I>Length</I>.</P>
<P CLASS="SubHead_Sans11">Syntax</P>
<P CLASS="Code">DWORD WINAPI PrimoSDK_PlayAudio(</P>
<P CLASS="Code_Indent">DWORD dwHandle,<BR>
PDWORD pdwUnit,<BR>
DWORD StartLba,<BR>
DWORD Length</P>
<P CLASS="Code">);</P>
<P CLASS="SubHead_Sans11">Parameters</P>
<P CLASS="SubHead_SubSans11">Input</P>
<P CLASS="Code_Ital">dwHandle</P>
<P CLASS="Def_Field">A DWORD specifying the operation&#39;s handle (see <A HREF="PS_Guide_6.htm#PrimoSDK_GetHandle">PrimoSDK_GetHandle</A>).</P>
<P CLASS="Code_Ital">StartLba</P>
<P CLASS="Def_Field">A DWORD specifying the logical block address of the sector at which playback is to begin.</P>
<P CLASS="Code_Ital">Length</P>
<P CLASS="Def_Field">A DWORD specifying the number of sectors to play.</P>
<P CLASS="SubHead_SubSans11">Input&#47;Output</P>
<P CLASS="Code_Ital">pdwUnit</P>
<P CLASS="Def_Field">A pointer to a DWORD identifying the unit by drive letter and&#47;or SCSI Host&#47;ID&#47;LUN triple (for the internal format of the DWORD, see <A HREF="#PrimoSDK_UnitInfo">PrimoSDK_UnitInfo</A>).</P>
<P CLASS="SubHead_Sans11">Returned values</P>
<P CLASS="Code_Ital">PRIMOSDK_OK</P>
<P CLASS="Def_Field">The call completed successfully.</P>
<P CLASS="Code_Ital">PRIMOSDK_CMDSEQUENCE</P>
<P CLASS="Def_Field">PrimoSDK is not yet initialized.</P>
<P CLASS="Code_Ital">PRIMOSDK_BADUNIT</P>
<P CLASS="Def_Field">The requested drive does not exist.</P>
<P CLASS="Code_Ital">PRIMOSDK_SCSIERROR</P>
<P CLASS="Def_Field">A communication error occurred, or the command went in time-out.</P>
<P CLASS="Code_Ital">PRIMOSDK_UNITERROR</P>
<P CLASS="Def_Field">The command returned a check condition (<I>pSense</I>, <I>pASC</I>, and <I>pASCQ</I> will point to the corresponding error triple).</P>
<P CLASS="Code_Ital">PRIMOSDK_BADHANDLE</P>
<P CLASS="Def_Field"><I>dwHandle</I> is not a valid handle.</P>
<P CLASS="Code_Ital">PRIMOSDK_INTERR</P>
<P CLASS="Def_Field">An internal error occured.</P>
<HR noshade SIZE=1 WIDTH="93%"><TABLE width="93%" align=center border=0><TBODY><col><col width=110><TR><TD CLASS="Heading4"><A ID="PrimoSDK_PauseResumeAudio">PrimoSDK_PauseResumeAudio</A></TD><TD class="IndentSansVisited">go: &nbsp;<A HRef="#chapter">top</A> &nbsp; &nbsp;| &nbsp; &nbsp;<A HRef="#Playback Control">section</A></TD></TR></TBODY></TABLE>
<P CLASS="IndentSerif">PrimoSDK_PauseResumeAudio pauses or resumes an audio playback operation (see <A HREF="#PrimoSDK_PlayAudio">PrimoSDK_PlayAudio</A>) involving a disc in the drive specified with the parameter <I>pdwUnit</I>. If audio is currently playing, set <I>bResume</I> to FALSE to pause playback. If audio is currently paused, set <I>bResume</I> to TRUE to resume playback.</P>
<P CLASS="SubHead_Sans11">Syntax</P>
<P CLASS="Code">DWORD WINAPI PrimoSDK_PauseResumeAudio(</P>
<P CLASS="Code_Indent">DWORD dwHandle,<BR>
PDWORD pdwUnit,<BR>
BOOL bResume</P>
<P CLASS="Code">);</P>
<P CLASS="SubHead_Sans11">Parameters</P>
<P CLASS="SubHead_SubSans11">Input</P>
<P CLASS="Code_Ital">dwHandle</P>
<P CLASS="Def_Field">A DWORD specifying the operation&#39;s handle (see <A HREF="PS_Guide_6.htm#PrimoSDK_GetHandle">PrimoSDK_GetHandle</A>).</P>
<P CLASS="Code_Ital">bResume</P>
<P CLASS="Def_Field">Boolean:<BR>
- if TRUE, continue playing;<BR>
- if FALSE, pause audio.</P>
<P CLASS="SubHead_SubSans11">Input&#47;Output</P>
<P CLASS="Code_Ital">pdwUnit</P>
<P CLASS="Def_Field">A pointer to a DWORD identifying the unit by drive letter and&#47;or SCSI Host&#47;ID&#47;LUN triple (for the internal format of the DWORD, see <A HREF="PS_Guide_6.htm#PrimoSDK_UnitInfo">PrimoSDK_UnitInfo</A>).</P>
<P CLASS="SubHead_Sans11">Returned values</P>
<P CLASS="Code_Ital">PRIMOSDK_OK</P>
<P CLASS="Def_Field">The call completed successfully.</P>
<P CLASS="Code_Ital">PRIMOSDK_CMDSEQUENCE</P>
<P CLASS="Def_Field">PrimoSDK is not yet initialized.</P>
<P CLASS="Code_Ital">PRIMOSDK_BADUNIT</P>
<P CLASS="Def_Field">The unit specified with <I>pdwUnit</I> does not exist.</P>
<P CLASS="Code_Ital">PRIMOSDK_SCSIERROR</P>
<P CLASS="Def_Field">A communication error occurred, or the command went in time-out.</P>
<P CLASS="Code_Ital">PRIMOSDK_UNITERROR</P>
<P CLASS="Def_Field">The command returned a check condition (<I>pSense</I>, <I>pASC</I>, and <I>pASCQ</I> will point to the corresponding error triple).</P>
<P CLASS="Code_Ital">PRIMOSDK_BADHANDLE</P>
<P CLASS="Def_Field"><I>dwHandle</I> is not a valid handle.</P>
<P CLASS="Code_Ital">PRIMOSDK_INTERR</P>
<P CLASS="Def_Field">An internal error occured.</P>
<HR noshade SIZE=1 WIDTH="93%"><TABLE width="93%" align=center border=0><TBODY><col><col width=110><TR><TD CLASS="Heading4"><A ID="PrimoSDK_StopAudio">PrimoSDK_StopAudio</A></TD><TD class="IndentSansVisited">go: &nbsp;<A HRef="#chapter">top</A> &nbsp; &nbsp;| &nbsp; &nbsp;<A HRef="#Playback Control">section</A></TD></TR></TBODY></TABLE>
<P CLASS="IndentSerif">PrimoSDK_StopAudio stops an audio playback operation (see <A HREF="#PrimoSDK_PlayAudio">PrimoSDK_PlayAudio</A>) involving a disc in the drive specified with the parameter <I>pdwUnit</I>.</P>
<P CLASS="SubHead_Sans11">Syntax</P>
<P CLASS="Code">DWORD WINAPI PrimoSDK_StopAudio(</P>
<P CLASS="Code_Indent">DWORD dwHandle,<BR>
PDWORD pdwUnit</P>
<P CLASS="Code">);</P>
<P CLASS="SubHead_Sans11">Parameters</P>
<P CLASS="SubHead_SubSans11">Input</P>
<P CLASS="Code_Ital">dwHandle</P>
<P CLASS="Def_Field">A DWORD specifying the operation&#39;s handle (see <A HREF="PS_Guide_6.htm#PrimoSDK_GetHandle">PrimoSDK_GetHandle</A>).</P>
<P CLASS="SubHead_SubSans11">Input&#47;Output</P>
<P CLASS="Code_Ital">pdwUnit</P>
<P CLASS="Def_Field">A pointer to a DWORD identifying the unit by drive letter and&#47;or SCSI Host&#47;ID&#47;LUN triple (for the internal format of the DWORD, see <A HREF="PS_Guide_6.htm#PrimoSDK_UnitInfo">PrimoSDK_UnitInfo</A>).</P>
<P CLASS="SubHead_Sans11">Returned values</P>
<P CLASS="Code_Ital">PRIMOSDK_OK</P>
<P CLASS="Def_Field">The call completed successfully.</P>
<P CLASS="Code_Ital">PRIMOSDK_CMDSEQUENCE</P>
<P CLASS="Def_Field">PrimoSDK is not yet initialized.</P>
<P CLASS="Code_Ital">PRIMOSDK_BADUNIT</P>
<P CLASS="Def_Field">The unit specified with <I>pdwUnit</I> does not exist.</P>
<P CLASS="Code_Ital">PRIMOSDK_SCSIERROR</P>
<P CLASS="Def_Field">A communication error occurred, or the command went in time-out.
</P>
<P CLASS="Code_Ital">PRIMOSDK_UNITERROR</P>
<P CLASS="Def_Field">The command returned a check condition (<I>pSense</I>, <I>pASC</I>, and <I>pASCQ</I> will point to the corresponding error triple).</P>
<P CLASS="Code_Ital">PRIMOSDK_BADHANDLE</P>
<P CLASS="Def_Field"><I>dwHandle</I> is not a valid handle.</P>
<P CLASS="Code_Ital">PRIMOSDK_INTERR</P>
<P CLASS="Def_Field">An internal error occured.</P>
<P CLASS="IndentSans"><A HRef= "#chapter">Top</A></P>
</BODY>
</HTML>
